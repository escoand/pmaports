# Contributor:
# Maintainer:
pkgname=net-cpp
pkgver=2.2.1
pkgrel=0
_commit=01fc17e8ce09bcee37e83422520e4c3f26e8c8dd
pkgdesc="A simple yet beautiful networking API for C++11"
url="https://launchpad.net/process-cpp"
arch="all"
license="LGPL3 GPL3"
depends=""
makedepends="cmake cmake-extras boost-dev curl-dev"
checkdepends="gtest-dev gmock process-cpp-dev properties-cpp-dev jsoncpp-dev"
install=""
subpackages="$pkgname-dev"
source="https://github.com/lib-cpp/net-cpp/archive/$_commit.tar.gz"
builddir="$srcdir/$pkgname-$_commit"
options="!check" # 50% tests passed, 2 tests failed out of 4

prepare() {
	default_prepare

	# Tests
#	sed -i 's/-Werror//g' "$builddir"/CMakeLists.txt
	truncate -s 0 "$builddir"/tests/CMakeLists.txt
}

build() {
	mkdir "$builddir"/build
	cd "$builddir"/build
	cmake .. \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DCMAKE_BUILD_TYPE=Release
	make
}

check() {
	cd "$builddir"/build
	make test
}

package() {
	cd "$builddir"/build
	make DESTDIR="$pkgdir/" install
}

sha512sums="b8aa59f6fdb6f2358a7f78845acf1af866186995613daa10a04497c3072dfbc034a552561d76c2d91c6e55b98c41bbf069052ca459531538ada4032a38d09afb  01fc17e8ce09bcee37e83422520e4c3f26e8c8dd.tar.gz"
