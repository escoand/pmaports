pkgname=wlroots
pkgver=0_git20180916
pkgrel=0
_commit="83397e69992aa407e3eae559fb41a991f1a68752"
pkgdesc="Pluggable, composable modules for building a Wayland compositor, with Purism hacks to support Phosh"
arch="all"
url="https://github.com/swaywm/wlroots"
license="MIT"
depends="wayland wayland-protocols xorg-server-xwayland"
depends_dev="libinput-dev xcb-util-image-dev"
makedepends="$depends_dev meson ninja mesa-dev eudev-dev pixman-dev wayland-dev libxkbcommon-dev"
subpackages="$pkgname-dev"
source="$pkgname-$pkgver.tar.gz::https://github.com/swaywm/wlroots/archive/$_commit.tar.gz"
options="suid"
builddir="$srcdir/$pkgname-$_commit"

build() {
	cd "$builddir"
	meson . _build --prefix=/usr -Denable-xwayland=true
	ninja -C _build
}

package() {
	cd "$builddir"
	
	DESTDIR="$pkgdir/" ninja -C _build install

	install -D -m755 _build/rootston/rootston "$pkgdir"/usr/bin/rootston
	chmod u+s "$pkgdir"/usr/bin/rootston
}
sha512sums="593a4d87f8e5684c3b325b227869728b1388b93be80cf23e0af3316d2684ddbec8916d836a5350096088a6c39ce0a4aa6b70f7059fd1857ac38718a77b45fd71  wlroots-0_git20180916.tar.gz"
