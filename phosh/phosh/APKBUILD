pkgname=phosh
pkgver=0_git20181218
pkgrel=0
_commit="ade8659b0448025c1ad9bf8ebba4b1a697e280ab"
pkgdesc="A shell PoC for the Librem5"
arch="all"
url="https://source.puri.sm/Librem5/phosh"
license="GPL2"
depends="gtk+3.0 wayland-protocols wlroots gnome-session bash dbus-x11 gnome-settings-daemon virtboard"
makedepends="gtk+3.0-dev meson ninja gnome-desktop-dev libhandy-dev gcr-dev upower-dev linux-pam-dev"
subpackages="$pkgname-lang"
source="$pkgname-$pkgver.tar.gz::https://source.puri.sm/Librem5/$pkgname/-/archive/$_commit.tar.gz"
options="!check" # Needs a running Wayland compositor
builddir="$srcdir/$pkgname-$_commit"

build() {
	cd "$builddir"
	meson . _build --prefix=/usr
	ninja -C _build
}

check() {
	cd "$builddir"
	ninja -C _build test
}

package() {
	cd "$builddir"
	DESTDIR="$pkgdir/" ninja -C _build install
}
sha512sums="780d33ea03d242d9fe63c721410724a0a91f8e7b39b07e037287a319a71f104a152b9140ef1574b557e047e3790504d5403d665ace385f71eb459cf27471ebd3  phosh-0_git20181218.tar.gz"
